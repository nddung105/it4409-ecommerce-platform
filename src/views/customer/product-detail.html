<!DOCTYPE html>
<html>

<head>
  <title id="title">Dell Latitude 7480 | eShop</title>
  <meta charset="UTF-8">
  <meta name="viewport"
    content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=0, minimum-scale=1.0, maximum-scale=1.0">
  <link rel="icon" type="image/png" href="../assets/customer/logo200px.png">

  <link href="https://fonts.googleapis.com/css2?family=Roboto&display=swap" rel="stylesheet">
  <link href="../css/customer/style.css" rel="stylesheet" type="text/css">
  <script src="https://kit.fontawesome.com/aa8e5675e3.js" crossorigin="anonymous"></script>

  <!--  -->
  <link rel="stylesheet" type="text/css" href="../css/customer/product-detail.css">
  <link rel="stylesheet" type="text/css" href="../css/customer/index.css">

  
</head>

<body class="overlay-scrollbar">
  <header class="header" id="header">
    <!-- navbar -->
    
    <div class="navbar">
      <ul class="navbar-nav">
        <li class="navbar-item" id="navbar-menu-btn" onclick="toggleMenu()">
          <i class="fas fa-bars navbar-icon"></i>
        </li>
        <li class="navbar-item">
          <a href="#"><img src="../assets/customer/logo-side1200_400px.png" alt="logo eshop" class="logo"></a>
        </li>
      </ul> 

      <ul class="navbar-nav navbar-tab">
        <li class="navbar-item">
          <a href="index.html" class="navbar-item-link" title="Trang chủ">Trang chủ</a>
        </li>
        <li class="navbar-item" id="products-cates">
          <a href="#" class="navbar-item-link" title="Sản phẩm" >Sản phẩm</a>
        </li>
        <li class="navbar-item">
          <a href="#" class="navbar-item-link" title="Liên hệ">Liên hệ</a>
        </li>
      </ul> 

      <div class="search-form-desktop">
        <form action="/pages/search-results-page" class="search-form">
            <input type="text" aria-label="Search products" placeholder="Tìm sản phẩm" class="search-input" id="search-input">
            <button class="search-button" type="submit" aria-label="Search">
                <span class="search-icon"><i class="fas fa-search"></i></span>
            </button>
        </form>
      </div>
      
      <ul class="navbar-nav">
        <li class="navbar-item dropdown search-form-mobile">
          <i class="fas fa-search navbar-search-icon navbar-icon dropdown-toggle" data-toggle="search-menu" title="Tìm kiếm"></i>
          
          <div id="search-menu" class="dropdown-menu search-bar">
            <form method="GET" action="Search" id="search-form" autocomplete="off">
              <input type="search" placeholder="Nhập thông tin sản phẩm, danh mục" name="searchValue" id="search-bar">
              <input type="submit" value="Tìm kiếm" id="search-button">
            </form>
          </div>
        </li>

        <li class="navbar-item dropdown">
          <i class="fas fa-user dropdown-toggle navbar-icon " data-toggle="user-menu" title="Tài khoản"></i>

          <ul id="user-menu" class="dropdown-menu">
            <li class="dropdown-menu-item">
              <a href="user_info.html" class="dropdown-menu-link">
                <i class="fas fa-user"></i>
                <span>Thông tin tài khoản</span>
              </a>
            </li>
            <li class="dropdown-menu-item">
              <a href="history_transaction.html" class="dropdown-menu-link">
                <i class="fas fa-shopping-bag"></i>
                <span>Lịch sử mua hàng</span>
              </a>
            </li>
            <li class="dropdown-menu-item">
              <a href="index_notlogin.html" class="dropdown-menu-link">
                <i class="fas fa-sign-out-alt"></i>
                <span>Đăng xuất</span>
              </a>
            </li>
          </ul>

        </li>
        <li class="navbar-item">
          <div class="login-button" id="login-button">
            <a href=""><span>Đăng nhập/</span>
              <span>Đăng ký</span>
            </a>              
          </div>
        </li>

        <li class="navbar-item">
          <div class="cart-wrapper">
            <i class="fas fa-shopping-cart cart-icon navbar-icon" title="Giỏ hàng"></i>
            <span class="cart-number-product" id="numberofproducts">0</span>
          </div>
        </li>
      </ul> 
      
    </div>
    <div class="navbar-column" id="navbar-menu">
      <ul class="navbar-nav-column ">
        <li class="navbar-item-column">
          <a href="index.html" class="navbar-link-column" title="Trang chủ">Trang chủ</a>
        </li>
        <li class="navbar-item-column">
          <a href="#" class="navbar-link-column" title="Sản phẩm">Sản phẩm</a>
        </li>
        <li class="navbar-item-column">
          <a href="#" class="navbar-link-column" title="Liên hệ">Liên hệ</a>
        </li>
      </ul>
    </div>
    <!--Menu cac loai san pham-->
    <div class="product-cate-link" id="product-cate-link">
      <a href="index.html" class="navbar-item-link" title="Trang chủ">Dell</a>
      <a href="index.html" class="navbar-item-link" title="Trang chủ">HP</a>
      <a href="index.html" class="navbar-item-link" title="Trang chủ">Razer</a>
      <a href="index.html" class="navbar-item-link" title="Trang chủ">Lenovo</a>
      <a href="index.html" class="navbar-item-link" title="Trang chủ">Asus</a>
      <a href="index.html" class="navbar-item-link" title="Trang chủ">Acer</a>
      <a href="index.html" class="navbar-item-link" title="Trang chủ">Microsoft</a>
      <a href="index.html" class="navbar-item-link" title="Trang chủ">Apple</a>
      <a href="index.html" class="navbar-item-link" title="Trang chủ">MSI</a>
      <a href="index.html" class="navbar-item-link" title="Trang chủ">LG</a>
    </div>

  </header>
  <!-- <div class="loading-wrapper">
    <img src="../assets/customer/loading5.gif">
  </div> -->
  <div class="add-product-success" id="add-product-success" >
    <span>Đã thêm sản phẩm vào giỏ hàng</span>
  </div>
  <main class="main-content">
    <div class="loading-wrapper">
      <img src="../assets/customer/logo-side180_60px.png" class="loading-logo logo">
      <p>Đang tải trang, bạn chờ một chút nhé ^^</p>
      <img src="../assets/customer/loading4-crop.gif" class="loading-gif">
    </div> 

    <div class="info-container">
      <div class="img-product-container" id="img-product-container">
        <h2 class="product-name" id="product-name-responsive"></h2>
        <img src="../assets/customer/product1.jpg" alt="product" id="product-image">
      </div>
      <div class="detail-container">
        <h2 class="product-name" id="product-name"></h2>
        <div class="product-price" >
          <p class="price-end" id="product-price"></p>
        <!-- <p class="price-discount">
            <span>15.000.000 đ</span> | <span>-20%</span>
          </p>-->

        </div>

        <hr>
        <p>Số Lượng</p>
        <div class="product-qty-container">
          <span class="decrease-qty value-button" onclick="decreaseValue(this)">-</span>
          <input class="input-qty" type="number" value="1" min="1"  max="5" id="number" required>
          <span class="increase-qty value-button" onclick="increaseValue(this)">+</span>
        </div>

        <a href="#" class="buy-btn" id="buy-btn">Chọn Mua</a>
      </div>
    </div>

    <div class="description-container">
      <h3 class="description-title">Mô tả sản phẩm</h3>
      <p class="description-p" id="description-p"></p>
    </div>

    <div class="box-vote">            
      <h3 class="description-title">Đánh giá của khách hàng</h3>
      <div class="star-vote-container">
        <div class="star-votes">
          <div class="star-vote" id="star-vote">
            <span class="fa fa-star " id="1"></span>
            <span class="fa fa-star " id="2"></span>
            <span class="fa fa-star " id="3"></span>
            <span class="fa fa-star " id="4"></span>
            <span class="fa fa-star" id="5"></span>
          </div>        
          <span id="numberofcomments"></span>
        </div>
        <a href="" class="btn-vote">Viết đánh giá</a>

      </div>

      <div class="reviews" id="reviews">
        <!-- <div class="review">
          <div class="star-votes">
            <span class="user-name">Nguyen Kim Tung</span>
            <div class="star-vote">
              <span class="fa fa-star checked"></span>
              <span class="fa fa-star checked"></span>
              <span class="fa fa-star checked"></span>
              <span class="fa fa-star checked"></span>
              <span class="fa fa-star"></span>
            </div>   
            
          </div>
          <p class="review-content">San pham that tuyet voi!!!</p>
          <div class="reply">
            <i class="fas fa-reply"></i>
            <div class="reply-content">
              <span class="admin-name">Admin</span>
              <span class="admin-reply">Cam on ban!</span>
            </div>
          </div>
        </div>
        <div class="review">
          <div class="star-votes">
            <span class="user-name">Nguyen Kim Tung</span>
            <div class="star-vote" >
              <span class="fa fa-star checked"></span>
              <span class="fa fa-star"></span>
              <span class="fa fa-star"></span>
              <span class="fa fa-star"></span>
              <span class="fa fa-star"></span>
            </div>   
            
          </div>
          <p class="review-content">San pham that tuyet voi!!!</p>
          <div class="reply">
            <i class="fas fa-reply"></i>
            <div class="reply-content">
              <span class="admin-name">Admin</span>
              <span class="admin-reply">Cam on ban!</span>
            </div>
          </div>
          
        </div> -->
    </div>

    <!--
          <div class="comment-box">
      <h3 class="description-title">Bình luận</h3>
      
      <a href="" class="btn-vote" id="btn-cmt">Viết bình luận</a>
      <div class="reviews">
        <div class="review">
          <div class="star-votes">
            <span class="user-name">Nguyen Kim Tung</span>
            <span class="email">tungnk183661@gmail.com</span>            
          </div>
          <p class="review-content">San pham ho tro nang cap bao nhieu RAM?</p>
          <div class="reply">
            <i class="fas fa-reply"></i>
            <div class="reply-content">
              <span class="admin-name">Admin</span>
              <span class="admin-reply">San pham ho tro nang cap them 8GB RAM ban nhe</span>
            </div>
          </div>

      </div>
      <div class="review">
        <div class="star-votes">
          <span class="user-name">Nguyen Kim Tung</span>
          <span class="email">tungnk183661@gmail.com</span>
          
        </div>
        <p class="review-content">San pham that tuyet voi!!!</p>
    </div>
    </div>
    </div>

    -->

  </main>

  <footer class="footer">
    <hr>
    <div class="footer-info-container">
      <div class="footer-info-column">
        <p class="footer-info-title">Về chúng tôi</p>
        <ul>
          <li class="footer-info-item">Giới thiệu</li>
          <li class="footer-info-item">Chính sách bảo mật thông tin</li>
        </ul>
      </div>
      <div class="footer-info-column">
        <p class="footer-info-title">Hỗ trợ khách hàng</p>
        <ul>
          <li class="footer-info-item">Hướng dẫn đặt hàng</li>
          <li class="footer-info-item">Hướng dẫn thanh toán</li>
          <li class="footer-info-item">Chính sách đổi trả</li>
          <li class="footer-info-item">
            <a target="_blank" href="mailto:hotro@eshop.vn">Hỗ trợ khách hàng: hotro@eshop.vn</a>
          </li>
          <li class="footer-info-item">
            <a target="_blank" href="mailto:hotro@eshop.vn">Báo lỗi hệ thống: system@eshop.vn</a>
          </li>

        </ul>
      </div>
      <div class="footer-info-column">
        <p class="footer-info-title">Liên hệ</p>
        <ul>
          <li class="footer-info-item">
            <i class="fas fa-map-marker-alt"></i>
            <a target="_blank"
              href="https://www.google.com/maps/place/Nh%C3%A0+TC+Tr%C6%B0%E1%BB%9Dng+%C4%90%E1%BA%A1i+H%E1%BB%8Dc+B%C3%A1ch+Khoa+H%C3%A0+N%E1%BB%99i/@21.0026909,105.8443743,17z/data=!3m1!4b1!4m5!3m4!1s0x3135ac76a80aa08f:0x4ebcb2843f16b1c!8m2!3d21.0026909!4d105.846563">
              104 Lê Thanh Nghị, Bách Khoa, Hai Bà Trưng, Hà Nội
            </a>
          </li>
          <li class="footer-info-item">
            <i class="fas fa-phone-alt"></i>
            <a target="_blank" href="tel:0989123456">0989123456</a>
          </li>
          <li class="footer-info-item">
            <i class="fas fa-envelope"></i>
            <a target="_blank" href="mailto:eshop@gmail.com">eshop@gmail.com</a>
          </li>
          <li class="footer-info-item">
            <a target="_blank" href="#" class="footer-link-icon"><i class="fab fa-facebook-square"></i></a>
            <a target="_blank" href="#" class="footer-link-icon"><i class="fab fa-twitter-square"></i></a>
            <a target="_blank" href="#" class="footer-link-icon"><i class="fab fa-instagram-square"></i></a>
            <a target="_blank" href="#" class="footer-link-icon"><i class="fab fa-youtube-square"></i></a>
          </li>
        </ul>
      </div>
    </div>
    <hr>
    <div>Coppyright &copy; 2021</div>
  </footer>
  <a id="go-to-head" onclick="topFunction()">
    <i class="fas fa-angle-up"></i>
  </a>

  <script src="../js/customer/index.js"></script>
  <script src="../js/customer/scrollToTop.js"></script>
  <script src="../js/customer/product.js"></script>

  <script>
    //PRODUCT
    const xhr = new XMLHttpRequest();
    let id = location.pathname.split('/').slice(-1);
    console.log(id)
    xhr.open("GET", "http://localhost:3000/api/v1/products/" + id, true);

    const title = document.getElementById('title');
    // When response is ready
    xhr.onload = function () {
        if (this.status === 200) {
          console.log("got it")
          // Changing string data into JSON Object
          obj = JSON.parse(this.responseText);
          console.log(obj)
          title.innerHTML = obj.name
          const productname = document.getElementById('product-name');
          productname.innerHTML = obj.name

          const productimage = document.getElementById("product-image");
          productimage.src = obj.image_link;
          console.log(obj.image_link)

          const productnameresponsive = document.getElementById('product-name-responsive');
          productnameresponsive.innerHTML = obj.name
          const productprice = document.getElementById('product-price')
          productprice.innerHTML = obj.price + ' đ'
          const des = document.getElementById('description-p')
          des.innerHTML = obj.description
        }
        else {
            console.log("File not found");
        }
    }
    xhr.send();


    //COMMENTS
    const cmt = new XMLHttpRequest();
    // let id = location.pathname.split('/').slice(-1);
    // console.log(id)
    cmt.open("GET", "http://localhost:3000/api/v1/comments?product_id="+id, true);
    
    // When response is ready
    cmt.onload = function () {
        if (this.status === 200) {
          console.log("got it")
          // Changing string data into JSON Object
          obj = JSON.parse(this.responseText);
          console.log(obj)
          // So luong danh gia
          const numberOfComments = document.getElementById('numberofcomments');
          numberOfComments.innerHTML = obj.total + " đánh giá";
          // Danh gia trung binh
          const rate = obj.rate;
          const starvote = document.getElementById(rate.toString());
          for(var i = 1; i<=rate; i++){
            var star = document.getElementById(i.toString());
            star.classList.add("checked")
          }
          //Binh luan
          const comments = obj.data;
          const reviews = document.getElementById("reviews");
          
          str = "";
          for(var i = 0; i<comments.length; i++){
            console.log(comments[i].rate)
            stars = "";
            stringID = comments[i].id.toString();
            stars += `<div class="review" id=${stringID}>
                        <div class="star-votes">
                            <span class="user-name">${comments[i].name}</span>
                            <div class="star-vote">
              `;
            for(var j=1; j<=comments[i].rate; j++){
              stars += `<span class="fa fa-star checked"></span>`;
              //console.log(stars);
            }

            stars += `
                  </div>  
                </div>`
            //console.log(stars)
            stars +=` <p class="review-content">${comments[i].content}</p>`
            stars+=`
              </div>
            `
            //console.log(stars)
            //CONTENT
            
            str+= stars
          }
          reviews.innerHTML= str;
        }
        else {
            console.log("File not found");
        }
    }
    cmt.send();
  </script>
  <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> -->
  <script>
    const loginbutton = document.getElementById('login-button')
    console.log(localStorage.getItem('name'))
    if (localStorage.getItem('token'))
    {
      console.log(1)
      loginbutton.innerHTML = `<span>${localStorage.getItem('name')}</span>`
    }
    const cart = document.getElementById("buy-btn");
    const numberofproducts = document.getElementById('numberofproducts');
    const addproductsuccess = document.getElementById('add-product-success');
    var num = numberofproducts.textContent;
    console.log(num)
    var timeout 
    cart.addEventListener('click', ()=>{
      num++;
      numberofproducts.innerHTML = num
      addproductsuccess.style.display = "block";
      timeout = setTimeout(hidefunction, 2000)

      // COOKIE CHO GIỎ HÀNG
      var quantity = document.getElementById('number').value
      var productorder = {
        'product_id' :id.toString(),
        'quantity' : quantity
      }
      
      // document.cookie.JSON = true
      console.log(productorder)
      console.log(typeof(productorder))
      // productorder = JSON.parse()
      productorder = JSON.stringify(productorder)
      // var e = 'Thu Nov 26 2023 15:44:38'; 
      // document.cookie = 'myObj='+ JSON.stringify(productorder) +';expires=' + e;
      document.cookie = id + "=" +productorder
      console.log(document.cookie)
      // decodedCookie = decodeURIComponent(document.cookie);
      // console.log(decodedCookie)
      

    })
    function hidefunction(){
      addproductsuccess.style.display = "none";
    }
  </script>

</body>

</html>
